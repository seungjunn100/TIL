# HTTP 통신과 Ajax - Fetch

- [Fetch API를 이용한 렌더링]()




<br />
<br />




## Fetch API를 이용한 렌더링

![Fetch API를 이용한 렌더링](../src/images/board-fetch-render.png)

### BoardInfo 컴포넌트

```tsx
function BoardInfo() {
  const [ data, setData ] = useState<BoardInfoView | null>(null);
  const [ isLoading, setIsLoading ] = useState(true);
  const [ error, setError ] = useState<Error | null>(null);

  const requestInfo = async () => {
    try {
      setIsLoading(true);
      const response = await fetch('https://fesp-api.koyeb.app/market/posts/6', {
        headers: {
          'client-id': 'openmarket',
        }
      });

      const jsonBody: ResData<BoardInfoRes> = await response.json();
      console.log(jsonBody);

      if (jsonBody.ok) {
        setData(jsonBody.item);
        setError(null);
      } else {
        throw new Error(jsonBody.message);
      }
    } catch(err) {
      setError(err as Error);
      setData(null);
    } finally {
      setIsLoading(false);
    }
  };

  useEffect(() => {
    requestInfo();
  }, []);

  return (
    <>
      { isLoading && <p>로딩중...</p> }

      { error && <p>{ error.message }</p> }

      {
        data && 
        <>
          <h2>{ data.title }</h2>
          <p>{ data.content }</p>
        </>
      }

      <CommentList />
    </>
  );
}
```

- `Fetch API`를 통해 `6`번 게시물의 데이터를 요청한다.
  
  - 헤더에 클라이언트 아이디를 추가해 어떤 클라이언트측에서 요청을 보냈는지 식별할 수 있도록 한다.

- `fetch`의 응답은 `JSON` 형태의 문자열로 오기 때문에 자바스크립트 객체로 파싱해줘야 한다.

- 응답에 성공하거나 실패할 경우에 따라 상태 관리를 통해 렌더링을 다시 하거나 하지 않도록 관리할 수 있다.

- 이 모든 작업은 컴포넌트가 

<br />

### CommentList 컴포넌트

<br />

### CommentNew 컴포넌트
